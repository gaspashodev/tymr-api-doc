<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tymr - API Documentation</title>
  <style>
    :root {
      --primary: #6366F1;
      --primary-dark: #4F46E5;
      --bg: #0F0F1A;
      --bg-card: #1A1A2E;
      --bg-code: #252540;
      --text: #FFFFFF;
      --text-secondary: #9CA3AF;
      --border: #2D2D3A;
      --success: #10B981;
      --warning: #F59E0B;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
    }

    .container { max-width: 900px; margin: 0 auto; padding: 40px 20px; }

    header {
      text-align: center;
      margin-bottom: 60px;
      padding: 40px;
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      border-radius: 20px;
    }

    header h1 { font-size: 48px; margin-bottom: 10px; }
    header p { font-size: 18px; opacity: 0.9; }

    section {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 30px;
      margin-bottom: 30px;
      border: 1px solid var(--border);
    }

    h2 {
      font-size: 24px;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    h2::before {
      content: '';
      width: 4px;
      height: 24px;
      background: var(--primary);
      border-radius: 2px;
    }

    h3 { font-size: 18px; margin: 25px 0 15px; color: var(--primary); }
    p { color: var(--text-secondary); margin-bottom: 15px; }

    table { width: 100%; border-collapse: collapse; margin: 20px 0; }
    th, td { text-align: left; padding: 12px 16px; border-bottom: 1px solid var(--border); }
    th { background: var(--bg-code); font-weight: 600; color: var(--text); }
    td { color: var(--text-secondary); }

    code {
      background: var(--bg-code);
      padding: 3px 8px;
      border-radius: 6px;
      font-family: 'SF Mono', Monaco, monospace;
      font-size: 14px;
      color: var(--success);
    }

    pre {
      background: var(--bg-code);
      padding: 20px;
      border-radius: 12px;
      overflow-x: auto;
      margin: 15px 0;
      border: 1px solid var(--border);
    }

    pre code { background: none; padding: 0; color: var(--text); }

    .endpoint {
      background: var(--bg);
      border-radius: 12px;
      padding: 20px;
      margin: 15px 0;
      border: 1px solid var(--border);
    }

    .endpoint-header { display: flex; align-items: center; gap: 12px; margin-bottom: 10px; }

    .method {
      background: var(--success);
      color: #fff;
      padding: 4px 12px;
      border-radius: 6px;
      font-weight: 600;
      font-size: 12px;
    }

    .endpoint-url { font-family: 'SF Mono', Monaco, monospace; color: var(--text); font-size: 14px; }
    .endpoint-desc { color: var(--text-secondary); font-size: 14px; }

    .base-url {
      background: linear-gradient(135deg, rgba(99, 102, 241, 0.2) 0%, rgba(79, 70, 229, 0.2) 100%);
      border: 1px solid var(--primary);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      margin: 20px 0;
    }

    .base-url code { font-size: 18px; background: var(--bg); padding: 8px 16px; }

    .tip {
      background: rgba(16, 185, 129, 0.1);
      border-left: 4px solid var(--success);
      padding: 15px 20px;
      border-radius: 0 12px 12px 0;
      margin: 20px 0;
    }

    .tip-title { font-weight: 600; color: var(--success); margin-bottom: 5px; }

    .comment { color: var(--text-secondary); }
    .string { color: #10B981; }
    .key { color: #60A5FA; }
    .number { color: #F59E0B; }

    footer { text-align: center; padding: 40px; color: var(--text-secondary); }
    footer a { color: var(--primary); text-decoration: none; }

    @media (max-width: 600px) {
      header h1 { font-size: 32px; }
      section { padding: 20px; }
      pre { font-size: 12px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>ðŸ“¡ Tymr API</h1>
      <p>Retrieve your game data in real-time</p>
    </header>

    <section>
      <h2>Base URL</h2>
      <div class="base-url">
        <code>https://tymr-server.up.railway.app</code>
      </div>
    </section>

    <section>
      <h2>Available Endpoints</h2>
      
      <div class="endpoint">
        <div class="endpoint-header">
          <span class="method">GET</span>
          <span class="endpoint-url">/api/sessions/join/{CODE}</span>
        </div>
        <p class="endpoint-desc">Find a session by its 6-character code</p>
      </div>

      <div class="endpoint">
        <div class="endpoint-header">
          <span class="method">GET</span>
          <span class="endpoint-url">/api/stream/{SESSION_ID}</span>
        </div>
        <p class="endpoint-desc">Optimized data for display (recommended)</p>
      </div>

      <div class="endpoint">
        <div class="endpoint-header">
          <span class="method">GET</span>
          <span class="endpoint-url">/api/party/{SESSION_ID}/stats</span>
        </div>
        <p class="endpoint-desc">Complete game statistics</p>
      </div>

      <div class="endpoint">
        <div class="endpoint-header">
          <span class="method">GET</span>
          <span class="endpoint-url">/api/party/{SESSION_ID}/player/{PLAYER_ID}</span>
        </div>
        <p class="endpoint-desc">Data for a specific player</p>
      </div>
    </section>

    <section>
      <h2>Stream Endpoint (recommended)</h2>
      <p>Ideal for overlays and real-time widgets.</p>
      
      <h3>Request</h3>
      <pre><code>GET https://tymr-server.up.railway.app/api/stream/{SESSION_ID}</code></pre>

      <h3>Response</h3>
      <pre><code>{
  <span class="key">"mode"</span>: <span class="string">"sequential"</span>,
  <span class="key">"globalTime"</span>: <span class="number">245</span>,
  <span class="key">"globalTimeFormatted"</span>: <span class="string">"4:05"</span>,
  <span class="key">"totalPlayers"</span>: <span class="number">4</span>,
  <span class="key">"players"</span>: [
    {
      <span class="key">"id"</span>: <span class="number">0</span>,
      <span class="key">"playerNumber"</span>: <span class="number">1</span>,
      <span class="key">"name"</span>: <span class="string">"Alice"</span>,
      <span class="key">"time"</span>: <span class="number">120</span>,
      <span class="key">"timeFormatted"</span>: <span class="string">"2:00"</span>,
      <span class="key">"isActive"</span>: <span class="number">false</span>,
      <span class="key">"isEliminated"</span>: <span class="number">false</span>,
      <span class="key">"isConnected"</span>: <span class="number">true</span>
    }
  ],
  <span class="key">"currentPlayer"</span>: <span class="string">"Bob"</span>,
  <span class="key">"currentPlayerId"</span>: <span class="number">1</span>
}</code></pre>

      <h3>Key Fields</h3>
      <table>
        <tr><th>Field</th><th>Description</th></tr>
        <tr><td><code>id</code></td><td>Player index (0, 1, 2...)</td></tr>
        <tr><td><code>playerNumber</code></td><td>Display number (1, 2, 3...)</td></tr>
        <tr><td><code>time</code></td><td>Time in seconds</td></tr>
        <tr><td><code>timeFormatted</code></td><td>Formatted time (e.g., "2:30")</td></tr>
        <tr><td><code>isActive</code></td><td>Is the timer running?</td></tr>
        <tr><td><code>isEliminated</code></td><td>Is the player eliminated?</td></tr>
        <tr><td><code>isConnected</code></td><td>Is the player connected?</td></tr>
      </table>
    </section>

    <section>
      <h2>Real-time with WebSocket</h2>
      <p>For instant updates without polling.</p>

      <h3>Installation</h3>
      <pre><code>&lt;script src="https://cdn.socket.io/4.6.0/socket.io.min.js"&gt;&lt;/script&gt;</code></pre>

      <h3>Connection</h3>
      <pre><code><span class="comment">// 1. Get the session ID</span>
const response = await fetch(
  `https://tymr-server.up.railway.app/api/sessions/join/${CODE}`
);
const { sessionId } = await response.json();

<span class="comment">// 2. WebSocket connection</span>
const socket = io(<span class="string">'https://tymr-server.up.railway.app'</span>, {
  transports: [<span class="string">'websocket'</span>]
});

<span class="comment">// 3. Join the session</span>
socket.on(<span class="string">'connect'</span>, () => {
  socket.emit(<span class="string">'join-session'</span>, sessionId);
});

<span class="comment">// 4. Receive updates</span>
socket.on(<span class="string">'session-state'</span>, (session) => {
  session.players.forEach(player => {
    console.log(`${player.name}: ${player.timeFormatted}`);
  });
});</code></pre>
    </section>

    <section>
      <h2>Usage Examples</h2>

      <h3>Simple Polling (without WebSocket)</h3>
      <pre><code>async function updateDisplay() {
  const response = await fetch(
    `https://tymr-server.up.railway.app/api/stream/${sessionId}`
  );
  const data = await response.json();
  
  document.getElementById(<span class="string">'total'</span>).textContent = data.globalTimeFormatted;
}

<span class="comment">// Refresh every second</span>
setInterval(updateDisplay, <span class="number">1000</span>);</code></pre>

      <div class="tip">
        <div class="tip-title">ðŸ’¡ Recommendation</div>
        <p>For stream overlays, use <strong>WebSocket</strong> for instant updates.</p>
      </div>
    </section>

    <section>
      <h2>FAQ</h2>

      <h3>How do I find the SESSION_ID?</h3>
      <p>Use <code>/api/sessions/join/{CODE}</code> with the 6-character code. The response contains the <code>sessionId</code>.</p>

      <h3>Difference between <code>id</code> and <code>playerNumber</code>?</h3>
      <table>
        <tr><th>Field</th><th>Usage</th><th>Example</th></tr>
        <tr><td><code>id</code></td><td>API calls</td><td>0, 1, 2...</td></tr>
        <tr><td><code>playerNumber</code></td><td>Display</td><td>1, 2, 3...</td></tr>
      </table>
    </section>

    <footer>
      <p>Tymr - Multiplayer Timer</p>
    </footer>
  </div>
</body>
</html>
